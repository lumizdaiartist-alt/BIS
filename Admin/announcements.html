<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Announcements</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"><style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Inter',sans-serif;
}

body{
    background:linear-gradient(135deg,#eef2ff,#f8fafc);
    min-height:100vh;
}

/* HEADER */
.header{
    display:flex;
    align-items:center;
    gap:12px;
    padding:22px;
    font-weight:600;
    font-size:20px;
}

.back{
    cursor:pointer;
    background:white;
    padding:8px;
    border-radius:10px;
    box-shadow:0 4px 12px rgba(0,0,0,0.06);
}

.container{
    max-width:900px;
    margin:auto;
    padding:20px;
}

/* CARD */
.card{
    background:white;
    border-radius:20px;
    padding:22px;
    margin-bottom:18px;
    box-shadow:0 10px 30px rgba(0,0,0,0.06);
    transition:.25s;
    position:relative;
    overflow:hidden;
}

.card:hover{
    transform:translateY(-4px);
    box-shadow:0 18px 40px rgba(0,0,0,0.08);
}

.badge{
    position:absolute;
    top:18px;
    right:18px;
    background:#eef2ff;
    color:#4f46e5;
    padding:6px 10px;
    border-radius:999px;
    font-size:12px;
    font-weight:600;
}

.title{
    font-size:20px;
    font-weight:700;
    margin-bottom:8px;
}

.message{
    color:#475569;
    line-height:1.6;
    margin-bottom:14px;
}

.meta{
    display:flex;
    justify-content:space-between;
    align-items:center;
    font-size:13px;
    color:#94a3b8;
}

.delete{
    border:none;
    background:#fee2e2;
    color:#dc2626;
    padding:6px 10px;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
}

.delete:hover{
    background:#fecaca;
}

/* EMPTY */
.empty{
    background:white;
    padding:60px 20px;
    border-radius:20px;
    text-align:center;
    color:#64748b;
    box-shadow:0 10px 30px rgba(0,0,0,0.05);
}

.empty span{
    font-size:50px;
    display:block;
    margin-bottom:10px;
}

/* LOADER */
.loader{
    width:42px;
    height:42px;
    border-radius:50%;
    border:4px solid #e5e7eb;
    border-top:4px solid #6366f1;
    animation:spin 1s linear infinite;
    margin:40px auto;
}

@keyframes spin{
    to{ transform:rotate(360deg);}    
}

</style></head>
<body><div class="header">
<span class="material-icons-outlined back" onclick="history.back()">arrow_back</span>
Announcements
</div><div class="container" id="container"><div class="loader" id="loader"></div><div class="empty" id="empty" style="display:none;">
<span class="material-icons-outlined">campaign</span>
No announcements yet.
</div></div><script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import {
    getFirestore,
    collection,
    query,
    orderBy,
    onSnapshot,
    deleteDoc,
    doc
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";


const firebaseConfig = {
  apiKey: "AIzaSyAibPUdGjS0PrpyssRFQVAPO-3BLpV-IaE",
  authDomain: "school-management-40c35.firebaseapp.com",
  projectId: "school-management-40c35",
  storageBucket: "school-management-40c35.firebasestorage.app",
  messagingSenderId: "314212845618",
  appId: "1:314212845618:web:21f9dc296501841dab542b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);


onAuthStateChanged(auth, user=>{
    if(!user) location.href="../index.html";
});


const container = document.getElementById("container");
const loader = document.getElementById("loader");
const empty = document.getElementById("empty");


const q = query(
    collection(db,"announcements"),
    orderBy("createdAt","desc")
);


onSnapshot(q, snapshot=>{

    loader.style.display="none";

    document.querySelectorAll(".card").forEach(el=>el.remove());

    if(snapshot.empty){
        empty.style.display="block";
        return;
    }

    empty.style.display="none";

    snapshot.forEach(docSnap=>{

        const data = docSnap.data();

        const card = document.createElement("div");
        card.className="card";

        const date = data.createdAt?.toDate()
            ?.toLocaleString() || "Just now";

        card.innerHTML=`
        <div class="badge">NEW</div>
        <div class="title">${data.title || "Announcement"}</div>
        <div class="message">${data.message || ""}</div>
        <div class="meta">
            <span>${date}</span>
            <button class="delete">Delete</button>
        </div>
        `;

        card.querySelector(".delete").onclick = async()=>{

            const confirmDelete = confirm("Delete this announcement?");
            if(!confirmDelete) return;

            await deleteDoc(doc(db,"announcements",docSnap.id));
        };

        container.appendChild(card);
    });

});

</script></body>
</html>